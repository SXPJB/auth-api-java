databaseChangeLog:
  - changeSet:
      id: 1
      author: sxpjb
      changes:
        - createTable:
            tableName: catalog
            columns:
              - column:
                  name: id
                  type: uuid
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: catalog
                  type: varchar(100)
                  constraints:
                    nullable: false
              - column:
                  name: code
                  type: varchar(100)
                  constraints:
                    nullable: false
              - column:
                  name: description
                  type: varchar(255)
                  constraints:
                    nullable: false
              - column:
                  name: active
                  type: boolean
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
        - addUniqueConstraint:
            columnNames: catalog, code
            tableName: catalog
        - dropAllForeignKeyConstraints:
            baseTableName: catalog
      rollback:
        - dropTable:
            tableName: catalog

  - changeSet:
      id: 2
      author: sxpjb
      changes:
        - sql:
            sql: drop extension if exists "uuid-ossp"; CREATE EXTENSION IF NOT EXISTS "uuid-ossp";
        - insert:
            tableName: catalog
            columns:
              - column:
                  name: id
                  valueComputed: uuid_generate_v4()
              - column:
                  name: catalog
                  value: c_gender
              - column:
                  name: code
                  value: F
              - column:
                  name: description
                  value: Female
        - insert:
            tableName: catalog
            columns:
              - column:
                  name: id
                  valueComputed: uuid_generate_v4()
              - column:
                  name: catalog
                  value: c_gender
              - column:
                  name: code
                  value: M
              - column:
                  name: description
                  value: Male
      rollback:
        - delete:
            tableName: catalog
            where:
              column:
                name: catalog='c_gender'

  - changeSet:
      id: 3
      author: sxpjb
      changes:
        - createTable:
            tableName: person
            columns:
              - column:
                  name: id
                  type: uuid
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: first_name
                  type: varchar(80)
                  constraints:
                    nullable: false
              - column:
                  name: last_name
                  type: varchar(80)
                  constraints:
                    nullable: false
              - column:
                  name: email
                  type: varchar(80)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: id_gender
                  type: uuid
                  constraints:
                    nullable: false
                    references:
                      foreignKeyName: fk_person_catalog
                      referencedTableName: catalog
                      referencedColumnNames: id
              - column:
                  name: active
                  type: boolean
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: timestamp
                  defaultValueComputed: current_timestamp
                  constraints:
                    nullable: false
              - column:
                  name: updated_at
                  type: timestamp
                  defaultValueComputed: current_timestamp
                  constraints:
                    nullable: false
      rollback:
        - dropTable:
            tableName: person

  - changeSet:
      id: 4
      author: sxpjb
      changes:
        - createTable:
            tableName: user
            columns:
              - column:
                  name: id
                  type: uuid
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: id_person
                  type: uuid
                  constraints:
                    nullable: false
                    references:
                      foreignKeyName: fk_user_person
                      referencedTableName: person
                      referencedColumnNames: id
              - column:
                  name: username
                  type: varchar(80)
                  constraints:
                    nullable: false
                    unique: true
              - column:
                  name: password
                  type: varchar(80)
                  constraints:
                    nullable: false
              - column:
                  name: token
                  type: varchar(255)
                  constraints:
                    unique: true
              - column:
                  name: is_confirmed
                  type: boolean
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: confirmation_code
                  type: varchar(255)
              - column:
                  name: confirmation_code_expires
                  type: timestamp
              - column:
                  name: active
                  type: boolean
                  defaultValueBoolean: true
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: timestamp
                  defaultValueComputed: current_timestamp
                  constraints:
                    nullable: false
              - column:
                  name: updated_at
                  type: timestamp
                  defaultValueComputed: current_timestamp
                  constraints:
                    nullable: false
      rollback:
        - dropTable:
            tableName: user